================================================================================
ProcessRunner Unit Test - File Structure
================================================================================

File: /Users/Warmonger0/tac/tac-webbuilder/app/server/tests/utils/test_process_runner.py

Total Lines: 1106
Total Tests: 47
Total Test Classes: 6
Total Fixtures: 4

================================================================================
TEST FILE STRUCTURE
================================================================================

[IMPORTS SECTION]
├── subprocess
├── unittest.mock (patch, MagicMock)
├── pytest
└── from utils.process_runner import ProcessRunner, ProcessResult

[FIXTURES SECTION - Lines 22-68]
├── mock_subprocess_success (return_value fixture)
│   ├── returncode=0
│   ├── stdout="output"
│   └── stderr=""
│
├── mock_subprocess_failure (return_value fixture)
│   ├── returncode=1
│   ├── stdout="partial output"
│   └── stderr="error message"
│
├── mock_subprocess_with_bytes (return_value fixture)
│   ├── returncode=0
│   ├── stdout=b"binary output"
│   └── stderr=b""
│
└── mock_subprocess_with_no_output (return_value fixture)
    ├── returncode=0
    ├── stdout=None
    └── stderr=None

[TEST CLASSES SECTION - Lines 70-1107]

1. CLASS: TestProcessRunnerRun (Lines 100-500)
   ├── Purpose: Test ProcessRunner.run() method
   ├── Test Count: 19 tests
   ├── Tests:
   │   ├── test_run_success_basic
   │   ├── test_run_failure_non_zero_returncode
   │   ├── test_run_timeout_handling
   │   ├── test_run_timeout_with_none_stdout_stderr
   │   ├── test_run_timeout_with_bytes_stdout_stderr
   │   ├── test_run_called_process_error_with_check_true
   │   ├── test_run_called_process_error_without_stdout_stderr
   │   ├── test_run_no_capture_output
   │   ├── test_run_with_timeout_parameter
   │   ├── test_run_with_default_timeout
   │   ├── test_run_with_no_timeout
   │   ├── test_run_with_cwd_parameter
   │   ├── test_run_with_check_true
   │   ├── test_run_text_parameter
   │   ├── test_run_command_string_formatting
   │   ├── test_run_with_log_command_true
   │   ├── test_run_with_log_command_false
   │   ├── test_run_logs_timeout
   │   ├── test_run_logs_error
   │   └── test_run_empty_command_list
   │
   └── Coverage:
       ├── Success paths
       ├── Failure paths
       ├── Timeout scenarios (3 variations)
       ├── Error handling (2 variations)
       ├── Output capture configurations
       ├── All parameters (timeout, cwd, check, text, capture_output, log_command)
       └── Logging behavior

2. CLASS: TestProcessRunnerGhCommand (Lines 502-600)
   ├── Purpose: Test ProcessRunner.run_gh_command() wrapper
   ├── Test Count: 4 tests
   ├── Tests:
   │   ├── test_run_gh_command_basic
   │   ├── test_run_gh_command_default_timeout (5s)
   │   ├── test_run_gh_command_custom_timeout
   │   └── test_run_gh_command_failure
   │
   └── Coverage:
       ├── "gh" prefix addition
       ├── Default 5-second timeout
       ├── Custom timeout override
       └── Error handling

3. CLASS: TestProcessRunnerGitCommand (Lines 602-735)
   ├── Purpose: Test ProcessRunner.run_git_command() wrapper
   ├── Test Count: 6 tests
   ├── Tests:
   │   ├── test_run_git_command_basic
   │   ├── test_run_git_command_default_timeout (10s)
   │   ├── test_run_git_command_custom_timeout
   │   ├── test_run_git_command_with_cwd
   │   ├── test_run_git_command_no_cwd
   │   └── test_run_git_command_failure
   │
   └── Coverage:
       ├── "git" prefix addition
       ├── Default 10-second timeout
       ├── Working directory handling (cwd)
       └── Error handling

4. CLASS: TestProcessRunnerShell (Lines 737-950)
   ├── Purpose: Test ProcessRunner.run_shell() wrapper
   ├── Test Count: 11 tests
   ├── Tests:
   │   ├── test_run_shell_basic
   │   ├── test_run_shell_with_pipes (|)
   │   ├── test_run_shell_with_variable_expansion ($VAR)
   │   ├── test_run_shell_with_command_substitution ($(cmd))
   │   ├── test_run_shell_default_timeout (30s)
   │   ├── test_run_shell_custom_timeout
   │   ├── test_run_shell_no_timeout
   │   ├── test_run_shell_with_cwd
   │   ├── test_run_shell_no_cwd
   │   ├── test_run_shell_failure
   │   └── test_run_shell_complex_command
   │
   └── Coverage:
       ├── bash -c wrapping
       ├── Shell features (pipes, variables, substitution)
       ├── Default 30-second timeout
       ├── Working directory handling
       └── Complex multi-operation commands

5. CLASS: TestProcessResult (Lines 952-1020)
   ├── Purpose: Test ProcessResult dataclass
   ├── Test Count: 3 tests
   ├── Tests:
   │   ├── test_process_result_creation
   │   ├── test_process_result_failure_state
   │   └── test_process_result_timeout_state
   │
   └── Coverage:
       ├── Field initialization
       ├── Failure state (success=False, returncode=1)
       └── Timeout state (success=False, returncode=-1)

6. CLASS: TestProcessRunnerIntegration (Lines 1022-1107)
   ├── Purpose: Test multiple components together
   ├── Test Count: 3 tests
   ├── Tests:
   │   ├── test_full_success_flow
   │   ├── test_full_failure_flow
   │   └── test_wrapper_methods_consistency
   │
   └── Coverage:
       ├── Complete success scenario
       ├── Complete failure scenario
       └── Wrapper method consistency

================================================================================
TEST STATISTICS
================================================================================

By Category:
├── ProcessRunner.run() method .......... 19 tests
├── run_gh_command() wrapper ............ 4 tests
├── run_git_command() wrapper ........... 6 tests
├── run_shell() wrapper ................. 11 tests
├── ProcessResult dataclass ............ 3 tests
└── Integration tests .................. 3 tests
                                        ──────
Total                                    47 tests

By Type:
├── Success scenarios ................... 15 tests
├── Failure scenarios ................... 8 tests
├── Timeout scenarios ................... 5 tests
├── Parameter verification ............. 12 tests
├── Edge cases .......................... 4 tests
└── Integration tests .................. 3 tests
                                        ──────
Total                                    47 tests

By Coverage Area:
├── Error Handling ...................... 25 tests
├── Timeout Handling .................... 5 tests
├── Parameter Handling .................. 12 tests
├── Output Handling ..................... 3 tests
└── Data Structure ...................... 2 tests
                                        ──────
Total coverage areas               47 test assertions

================================================================================
FIXTURE USAGE SUMMARY
================================================================================

mock_subprocess_success
├── Used by: 7 tests
├── Purpose: Return successful execution
└── Values: returncode=0, stdout="output", stderr=""

mock_subprocess_failure
├── Used by: 2 tests
├── Purpose: Return failed execution
└── Values: returncode=1, stdout="partial output", stderr="error message"

mock_subprocess_with_bytes
├── Used by: 0 tests (available for future use)
├── Purpose: Test bytes output handling
└── Values: returncode=0, stdout=b"binary output", stderr=b""

mock_subprocess_with_no_output
├── Used by: 0 tests (available for future use)
├── Purpose: Test no captured output
└── Values: returncode=0, stdout=None, stderr=None

================================================================================
ERROR HANDLING COVERAGE
================================================================================

Exception Types Tested:
├── subprocess.TimeoutExpired
│   ├── With stdout/stderr content
│   ├── With None stdout/stderr
│   ├── With bytes stdout/stderr
│   └── Message formatting tested
│
├── subprocess.CalledProcessError
│   ├── With full stdout/stderr
│   ├── With missing stdout/stderr attributes
│   └── returncode preservation tested
│
└── Non-zero returncodes
    ├── returncode=1 (general failure)
    ├── returncode=127 (command not found)
    ├── returncode=128 (fatal git error)
    └── Output capture tested

================================================================================
PARAMETER COMBINATIONS TESTED
================================================================================

timeout parameter:
├── Default (30 seconds)
├── Custom (5s for gh, 10s for git, 15s custom)
└── None (no timeout)

capture_output parameter:
├── True (default, capture output)
└── False (no capture)

text parameter:
├── True (string output)
└── False (binary output)

cwd parameter:
├── Specified path
└── None (current directory)

check parameter:
├── True (raise on error)
└── False (return result)

log_command parameter:
├── True (enable logging)
└── False (no logging)

================================================================================
TEST ORGANIZATION PRINCIPLE
================================================================================

Each test class focuses on a specific method:
├── TestProcessRunnerRun ............... Core run() method
├── TestProcessRunnerGhCommand ........ GitHub CLI wrapper
├── TestProcessRunnerGitCommand ....... Git wrapper
├── TestProcessRunnerShell ............ Shell wrapper
├── TestProcessResult ................. Data structure
└── TestProcessRunnerIntegration ...... Multi-component tests

Within each class, tests are organized by:
├── Success scenarios (first)
├── Failure scenarios (second)
├── Edge cases (third)
├── Parameter variations (fourth)
└── Integration scenarios (last)

================================================================================
MOCKING STRATEGY
================================================================================

All subprocess calls are mocked:
├── Mock target: subprocess.run()
├── Mock method: patch("subprocess.run")
├── Return values: MagicMock with controlled attributes
├── Side effects: Configured for exception testing
└── Verification: call_args and call_kwargs checked

Benefits:
├── No real process execution (safe)
├── Fast test execution (no system calls)
├── Isolated tests (no side effects)
├── Predictable results (same mocks every time)
├── Easy error scenario testing

================================================================================
TEST EXECUTION
================================================================================

Quick Run All Tests:
$ cd /Users/Warmonger0/tac/tac-webbuilder/app/server
$ uv run pytest tests/utils/test_process_runner.py -v

Run Specific Test Class:
$ uv run pytest tests/utils/test_process_runner.py::TestProcessRunnerRun -v

Run Single Test:
$ uv run pytest tests/utils/test_process_runner.py::TestProcessRunnerRun::test_run_success_basic -v

Expected Result:
✓ 47 tests PASSED (< 1 second execution time)

================================================================================
CODE QUALITY METRICS
================================================================================

Documentation:
├── File docstring: ✓ (describes all test areas)
├── Class docstrings: ✓ (one per test class)
├── Method docstrings: ✓ (all 47 tests documented)
├── Inline comments: ✓ (complex logic explained)
└── Section headers: ✓ (organize content)

Code Organization:
├── Consistent naming: ✓ (test_* convention)
├── Logical grouping: ✓ (organized by method)
├── Fixture reuse: ✓ (4 shared fixtures)
├── No code duplication: ✓ (fixtures reduce duplication)
└── Clear AAA pattern: ✓ (Arrange-Act-Assert)

Test Quality:
├── Single responsibility: ✓ (one concept per test)
├── Independent tests: ✓ (no interdependencies)
├── Specific assertions: ✓ (not overly general)
├── Clear test names: ✓ (describes what's tested)
└── Fast execution: ✓ (all mocked, no I/O)

================================================================================
RELATED DOCUMENTATION
================================================================================

├── TEST_RESULTS_SUMMARY.md ............ Comprehensive test documentation
├── TESTS_QUICK_REFERENCE.md .......... Quick command reference
└── TEST_STRUCTURE.txt ................ This file (visual structure)

Main Module:
└── utils/process_runner.py ........... Module under test

================================================================================
